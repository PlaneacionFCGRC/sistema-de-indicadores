<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sistema de Indicadores</title>

  <!-- ChartJS -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Estilos -->
  <link rel="stylesheet" href="css/style2.css" />
</head>

<body class="inicio-activo">

<!-- SIDEBAR -->
<!-- SIDEBAR -->
<div id="sidebar" class="sidebar hidden" aria-hidden="true">

  <!-- Botón hamburguesa (solo móvil) -->
  <button id="hamburgerBtn">☰ Menú</button>

  <label class="municipio-title"></label>

  <input id="searchMunicipioSidebar" class="search-box" placeholder="Buscar municipio...">

  <ul id="municipioListSidebar" class="municipio-list"></ul>
</div>

<!-- HEADER -->
<header class="topbar topbar-white">
  <div class="topbar-inner">
    <div class="brand">
      <object type="image/svg+xml" data="img/logo_fcgrc.svg" class="logo-svg" aria-label="Logo Fundación"></object>
      <div class="brand-text">
        <h1 class="tooltip-gri">
            Reporte GRI Población Participante
             <span class="tooltip-gri-text">
                La plataforma Reporte GRI – Población Participante es un sistema digital que permite registrar, consolidar y analizar la información de las actividades, estrategias y poblaciones atendidas por la Fundación Caicedo González Riopaila Castilla, facilitando la gestión y generación de reportes.
               </span>
            </h1>

      </div>
    </div>
    <div class="spacer"></div>
  </div>
</header>

<!-- SUBNAV -->
<nav id="subNav" class="subnav hidden">
  <div id="reporteBtn" class="subnav-item">Seleccione Municipio</div>
  <button id="dashboardBtn" class="subnav-item">Resultados</button>
</nav>

<!-- MAIN -->
<main class="main-area">
  <section class="content">

    <!-- PANTALLA INICIO -->
    <div id="inicioPantalla" class="inicio-container">
            <div class="inicio-card">
        <button id="btnReporteInfo" class="inicio-btn">Reporte de Información</button>
      </div>

      <div class="inicio-card">
        <button id="btnResultados" class="inicio-btn">Consolidado</button>
      </div>


    </div>

    <!-- DASHBOARD -->
    <div id="dashboard" class="dashboard hidden">

      <div style="display:flex;justify-content:space-between;align-items:center">
        <h2 class="GeneralDash">Resultados</h2>
        <div>
          <button id="btnVolverFormulario" class="btn-save" style="margin-right:8px">Volver al formulario</button>
        </div>
      </div>

      <!-- SEGMENTADORES -->
      <div class="filtros-dashboard" style="display:flex;gap:14px;flex-wrap:wrap;margin:12px 0 20px 0;align-items:center;">
        
        <div class="card" style="padding:12px;min-width:160px;flex:0 0 auto;">
          <div style="font-weight:800;margin-bottom:8px;color:#333">Año</div>
          <select id="filtroAnioDashboard">
            <option value="">Todos</option>
            <option>2022</option><option>2023</option>
            <option>2024</option><option>2025</option>
            <option>2026</option><option>2027</option>
            <option>2028</option>
          </select>
        </div>

        <div class="card" style="padding:12px;min-width:220px;flex:0 0 auto;">
          <div style="font-weight:800;margin-bottom:8px;color:#333">Municipio</div>
          <select id="filtroMunicipioDashboard">
            <option value="">Todos</option>
          </select>
        </div>

        <div class="card" style="padding:12px;min-width:180px;flex:0 0 auto;">
          <div style="font-weight:800;margin-bottom:8px;color:#333">Población</div>
          <select id="filtroPoblacionDashboard">
            <option value="">Todas</option>
            <option value="DIRECTA">Directa</option>
            <option value="INDIRECTA">Indirecta</option>
          </select>
        </div>

        <div class="card" style="padding:12px;min-width:260px;flex:0 0 auto;">
          <div style="font-weight:800;margin-bottom:8px;color:#333">Sujeto de intervención</div>
          <select id="filtroSujetoDashboard">
            <option value="">Todos</option>
          </select>
        </div>

      </div>
      <!-- /filtros -->

      <!-- KPIs -->
      <div class="dashboard-kpis" style="display:flex;gap:18px;flex-wrap:wrap;margin-bottom:20px;align-items:stretch;">

        <div class="card" style="flex:1;min-width:180px;text-align:center;padding:18px;">
          <h3 id="kpiTituloSujeto" style="margin-bottom:8px">Total Sujeto</h3>
          <div id="kpiValorSujeto" style="font-size:28px;font-weight:800">0</div>
        </div>

        <div class="card" style="flex:1;min-width:140px;text-align:center;padding:18px;">
          <h3 id="kpiTituloDirecta" style="margin-bottom:8px">Directa</h3>
          <div id="kpiDirecta" style="font-size:24px;font-weight:800">0</div>
        </div>

        <div class="card" style="flex:1;min-width:140px;text-align:center;padding:18px;">
          <h3 id="kpiTituloIndirecta" style="margin-bottom:8px">Indirecta</h3>
          <div id="kpiIndirecta" style="font-size:24px;font-weight:800">0</div>
        </div>

        <div class="card" style="flex:1;min-width:140px;text-align:center;padding:18px;">
          <h3 id="kpiTituloRegistros" style="margin-bottom:8px">Total Registros</h3>
          <div id="kpiRegistros" style="font-size:24px;font-weight:800">0</div>
        </div>

      </div>
      <!-- /KPIs -->

      <!-- GRÁFICAS -->
      <div class="dashboard-charts" style="display:flex;gap:16px;flex-wrap:wrap;align-items:flex-start;margin-bottom:18px;">

        <div class="chart-box card" style="flex:1;min-width:260px;max-width:36%;padding:12px;display:flex;flex-direction:column;">
          <h3 style="margin-bottom:8px">Participantes por Estrategia</h3>
          <div style="flex:1;min-height:260px;display:flex;align-items:center;justify-content:center;">
            <canvas id="chartEstrategias" style="width:100%;height:100%"></canvas>
          </div>
        </div>

        <div class="chart-box card" style="flex:1;min-width:220px;max-width:32%;padding:12px;display:flex;flex-direction:column;">
          <h3 style="margin-bottom:8px">Directa / Indirecta</h3>
          <div style="flex:1;min-height:260px;display:flex;align-items:center;justify-content:center;">
            <canvas id="chartPoblacion" style="width:100%;height:100%"></canvas>
          </div>
        </div>

        <div class="chart-box card" style="flex:1;min-width:220px;max-width:32%;padding:12px;display:flex;flex-direction:column;">
          <h3 style="margin-bottom:8px">Sujeto de intervención</h3>
          <div style="flex:1;min-height:260px;display:flex;align-items:center;justify-content:center;">
            <canvas id="chartSujetos" style="width:100%;height:100%"></canvas>
          </div>
        </div>

      </div>
      <!-- /GRÁFICAS -->

      <!-- TABLA ESTRATEGIA VS % -->
<div class="card" style="margin-top:6px;padding:14px;">
  <h3 id="tituloTablaEstrategia" style="margin-bottom:10px">% (porcentaje según filtros)</h3>
        <div class="table-wrap" style="overflow:auto;">
          <table id="tablaEstrategiaSujeto" class="tabla-registros" style="min-width:480px;">
            <thead>
              <tr>
                <th>ESTRATEGIA</th>
                <th>%</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

    </div>
    <!-- /DASHBOARD -->

    <!-- FORMULARIO MUNICIPIO -->
    <div id="formWrap" class="card card-form form-container hidden">
      <h2 class="selected-title" id="SelectedMunicipio">Municipio seleccionado: <span id="municipioSeleccionado">—</span></h2>

      <h3 id="titulo_form">Por favor registre la información en el siguiente formulario.</h3>

      <label>Año de reporte</label>
      <select id="anioReporte">
        <option value="">Seleccione...</option>
        <option>2022</option><option>2023</option>
        <option>2024</option><option>2025</option>
        <option>2026</option><option>2027</option>
        <option>2028</option>
      </select>

      <label>Población</label>
      <select id="poblacion">
        <option value="">Seleccione...</option>
        <option value="DIRECTA">DIRECTA</option>
        <option value="INDIRECTA">INDIRECTA</option>
      </select>

      <label>1. Estrategia de Acompañamiento</label>
      <select id="estrategia"><option value="">Seleccione...</option></select>

      <label>2. Despliegue (si aplica)</label>
      <select id="despliegue" class="hidden"></select>

      <label>3. Sujeto de Intervención</label>
      <select id="sujeto"><option value="">Seleccione...</option></select>

      <label>4. Cantidad</label>
      <input id="cantidad" type="number" min="1"/>

      <label>5. Observaciones</label>
      <textarea id="observaciones" rows="4"></textarea>

      <div class="form-actions">
        <button id="guardarBtn" class="btn-save">Guardar Registro</button>
        <button id="cancelarEdicion" class="btn-cancel hidden">Cancelar edición</button>
      </div>

      <button id="btnConsolidado" class="btn-save" style="margin-top:20px;" disabled>Ver Consolidado</button>
    </div>

    <!-- TOTALES MUNICIPIO -->
    <div id="totalsContainer" class="totals-container hidden">
      <div class="card-total small-card">
        <div class="total-left">Población<br>Directa</div>
        <div id="totalDirectaPersonas" class="total-right">0</div>
      </div>

      <div class="card-total small-card">
        <div class="total-left">Población<br>Indirecta</div>
        <div id="totalIndirectaPersonas" class="total-right">0</div>
      </div>

         <div class="card-total small-card tooltip">
  <div class="total-left">Población<br>Total</div>
  <div id="totalAcumulado" class="total-right">0</div>

  <span class="tooltip-text">
    Este valor de población hace referencia al sujeto de intervención "personas participantes".
  </span>
</div>
</div> 

    <!-- TABLA MUNICIPIO -->
    <div id="tableWrap" class="card card-table hidden">
      <h3>Registros Guardados</h3>
      <div class="table-wrap">
        <table id="tablaRegistros" class="tabla-registros">
          <thead>
            <tr>
              <th>AÑO</th>
              <th>MUNICIPIO</th>
              <th>SUJETO</th>
              <th>POBLACIÓN</th>
              <th>ESTRATEGIA</th>
              <th>DESPLIEGUE</th>
              <th>CANTIDAD</th>
              <th>FECHA</th>
              <th>ACCIONES</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

  </section>
</main>

<script type="module" src="js/app_api2.js"></script>
<script type="module" src="js/app2.js"></script>

</body>
</html>
